{% extends 'base.html' %}
{% include 'templates/navbar.html' %}
{% block title %} NIMS | file upload {% endblock title %}


{% block content %}

 {% include 'navbar.html' %}

<div class="container">
	<div class="row">
		<div class="instructions">
			<h1>To Make Payments:</h1>
			<p>Upload an <span>Excel</span> or <span>CSV</span> file with a list of one or more recepients
			</p>
			<p class="more-instructions"><a href="#collapse-instructions" aria-expanded="false" aria-controls="collapseInstructions" data-toggle="collapse">click for instructions</a></p>

			<div class="collapse" id="collapse-instructions">
				<p>1) Upload an Excel or CSV file</p>
				<p>2) View your information in a table</p>
				<p>3) Send your payments</p>
			</div>
  		</div>
		<div class="upload-buttons">
			<div class="upload-excel-btn">
			{% if form.errors %}
				<p style="color: red;">
					Please correct the error{{ form.errors|pluralize }} below.
				</p>
			<br/>
			{% endif %}
				<form action="" method="POST" enctype="multipart/form-data" class="upload-form">

					{{ form.as_table }}

					{% csrf_token %}

					<button type="submit" name="uploadfile" id="uploadfile" value="" class="btn btn-primary"><i class="fa fa-upload"></i>Upload file </button>
				</form>


			    <script>
                    $(document).ready(function () {
                    $('input[type=file]').change(function () {
                    var val = $(this).val().toLowerCase();
                    var regex = new RegExp("(.*?)\.(xlsx|csv)$");
                    if(!(regex.test(val))) {
                        $(this).val('');
                        alert('Please upload an Excel or CSV file');
                    } }); });
                </script>




			</div>


		</div>

	</div>
</div>

{% endblock content %}